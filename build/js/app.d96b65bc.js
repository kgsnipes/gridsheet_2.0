!function(t){function e(e){for(var o,s,u=e[0],l=e[1],a=e[2],c=0,f=[];c<u.length;c++)s=u[c],i[s]&&f.push(i[s][0]),i[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);for(h&&h(e);f.length;)f.shift()();return r.push.apply(r,a||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,u=1;u<n.length;u++){var l=n[u];0!==i[l]&&(o=!1)}o&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},i={0:0},r=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var u=window.webpackJsonp=window.webpackJsonp||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var a=0;a<u.length;a++)e(u[a]);var h=l;r.push([126,1]),n()}({126:function(t,e,n){"use strict";n.r(e);n(9),n(20),n(93),n(3),n(4),n(5),n(97),n(2),n(6),n(103),n(7),n(8);function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this._enableLogging=!0}var e,n,r;return e=t,(n=[{key:"appendComponentName",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e&&"string"==typeof e[0]&&(e[0]=this.name+" : "+e[0]),e}},{key:"info",value:function(){var t,e=this.appendComponentName.apply(this,arguments);console.info&&_enableLogging&&(t=console).info.apply(t,o(e))}},{key:"debug",value:function(){var t,e=this.appendComponentName.apply(this,arguments);console.debug&&_enableLogging?(t=console).debug.apply(t,o(e)):_enableLogging&&this.info.apply(this,o(e))}},{key:"error",value:function(){var t,e=this.appendComponentName.apply(this,arguments);console.error&&_enableLogging?(t=console).error.apply(t,o(e)):_enableLogging&&this.info.apply(this,o(e))}},{key:"warn",value:function(){var t,e=this.appendComponentName.apply(this,arguments);console.warn&&_enableLogging?(t=console).warn.apply(t,o(e)):_enableLogging&&this.info.apply(this,o(e))}}])&&i(e.prototype,n),r&&i(e,r),t}(),s={dimension:{width:1e3,height:400,units:"px"},initialColumns:10,defaultColumnWidth:100,initialRows:50,defaultRowHeight:30,gutterColumnColor:"#cccccc",defaultContentColor:"#000000",currentContentColor:"#000000",initialSheets:10,defaultSheetNamePrefix:"untitled",topbarHeight:1,bottombarHeight:30,defaultFontFamily:"Helvetica",gutterPadding:5,columnResizeHandlesWidth:2};n(10),n(11),n(83);function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.options=n}var e,n,o;return e=t,(n=[{key:"render",value:function(){}},{key:"repaint",value:function(){}}])&&u(e.prototype,n),o&&u(e,o),t}();function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=c(this,f(e).call(this,t,n))).logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("div"),this.element.style.width=this.options.parent.element.style.width,this.element.style.height=this.options.topbarHeight+this.options.dimension.units,this.element.style.top=this.getTopBarTop()+this.options.dimension.units,this.element.classList.add("topbar"),this.options.parent.element.appendChild(this.element)}},{key:"getTopBarTop",value:function(){return this.options.parent.element.getBoundingClientRect().top}}])&&h(n.prototype,o),i&&h(n,i),e}();n(43),n(54),n(88),n(55),n(117),n(122);function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"getColumnNameFromColumnNumber",value:function(t){return this.getColumnName("",t)}},{key:"getColumnName",value:function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(e>n.length){var o=e%n.length;return 0===o?this.getColumnName(n.charAt(e/n.length-2)+t,n.length):this.getColumnName(n.charAt(e/n.length-1)+t,o)}return t+n.charAt(e-1)}},{key:"getTextDisplayWidth",value:function(t,e){var n=this.getFontSpecForComponent(e);return this.displayTextWidth(t,n)}},{key:"displayTextWidth",value:function(t,e){var n=(this.canvas||(this.canvas=document.createElement("canvas"))).getContext("2d");return n.font=e,n.measureText(t).width}},{key:"getFontSpecForComponent",value:function(t){return(t.element.style.fontStyle?t.element.style.fontStyle:"normal")+" "+(t.element.style.fontSize?t.element.style.fontSize:"12")+"px "+(t.element.style.fontFamily?t.element.style.fontFamily:t.options.defaultFontFamily)}},{key:"reverseString",value:function(t){return t.split("").reverse().join("")}},{key:"getPxFromStyle",value:function(t){return parseInt(t.substring(0,t.indexOf("px")).trim())}}],(n=null)&&d(e.prototype,n),o&&d(e,o),t}();function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function v(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var O=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=v(this,w(e).call(this,t,n))).logger=new r(o.constructor.name),o.sheetButtons=new Array,o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.sheetName=this.options.sheetName,this.sheetNumber=this.options.sheetNumber,this.addSheetButtonContainerDOM()}},{key:"addSheetButtonContainerDOM",value:function(){this.sheetButtonScrollContainer=document.createElement("div"),this.sheetButtonScrollContainer.classList.add("sheetbuttonscrollcontainer"),this.sheetButtonScrollContainer.setAttribute("id","sheetbuttonscrollcontainer"),this.options.parent.element.appendChild(this.sheetButtonScrollContainer),this.element=document.createElement("div"),this.element.classList.add("sheetbuttoncontainer"),this.element.setAttribute("id","sheetbuttoncontainer"),this.sheetButtonScrollContainer.appendChild(this.element)}},{key:"adjustWidthForSheetButtonContainer",value:function(){this.element.style.width=this.getChildrenWidth()+this.options.dimension.units}},{key:"getChildrenWidth",value:function(){var t=0;return this.sheetButtons.forEach(function(e){t+=y.getPxFromStyle(e.element.style.width)+20}),t}},{key:"scrollSheetContainerToLeft",value:function(t){var e=y.getPxFromStyle(this.element.style.left)||0,n=y.getPxFromStyle(this.element.style.width);e+t<=0&&e+t>-n-t&&(this.element.style.left=e+t+this.options.dimension.units)}}])&&g(n.prototype,o),i&&g(n,i),e}();function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function k(t,e){return!e||"object"!==S(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var E=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=k(this,_(e).call(this,t,n))).logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.addSheetButtonScrollPanelDOM(),this.addEventListener()}},{key:"addSheetButtonScrollPanelDOM",value:function(){this.element=document.createElement("div"),this.element.classList.add("sheetbuttonscrollpanel"),this.element.setAttribute("id","sheetbuttonscrollpanel"),this.options.parent.element.appendChild(this.element),this.rightScrollButton=document.createElement("button"),this.leftScrollButton=document.createElement("button"),this.rightScrollButton.classList.add("sheetbuttonscrollpanel_button"),this.leftScrollButton.classList.add("sheetbuttonscrollpanel_button"),this.rightScrollButton.innerHTML=">",this.leftScrollButton.innerHTML="<",this.element.appendChild(this.leftScrollButton),this.element.appendChild(this.rightScrollButton)}},{key:"addEventListener",value:function(){var t=this;this.leftScrollButton.addEventListener("click",function(e){t.scrollTheButtonsContainerToLeft()}),this.rightScrollButton.addEventListener("click",function(e){t.scrollTheButtonsContainerToRight()})}},{key:"scrollTheButtonsContainerToLeft",value:function(){this.options.parent.sheetButtonContainer.scrollSheetContainerToLeft(100)}},{key:"scrollTheButtonsContainerToRight",value:function(){this.options.parent.sheetButtonContainer.scrollSheetContainerToLeft(-100)}}])&&j(n.prototype,o),i&&j(n,i),e}();function L(t){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function T(t,e){return!e||"object"!==L(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var R=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=T(this,B(e).call(this,t,n))).logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("div"),this.element.style.width=this.options.parent.element.style.width,this.element.style.height=this.options.bottombarHeight+this.options.dimension.units,this.element.style.top=this.getBottomBarTop()+this.options.dimension.units,this.element.classList.add("bottombar"),this.options.parent.element.appendChild(this.element),this.addSheetButtonContainer()}},{key:"addSheetButtonContainer",value:function(){this.sheetButtonContainer=new O(null,Object.assign({},this.options,{parent:this})),this.sheetButtonScrollPane=new E(null,Object.assign({},this.options,{parent:this}))}},{key:"getBottomBarTop",value:function(){var t=this.options.parent.element.getBoundingClientRect();return t.top+t.height-this.options.bottombarHeight}}])&&N(n.prototype,o),i&&N(n,i),e}();n(124);function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function H(t,e){return!e||"object"!==F(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function W(t){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var G=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=H(this,W(e).call(this,t,n))).logger=new r(o.constructor.name),o.render(),o.sheet=n.sheet,o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.sheetName=this.options.sheetName,this.sheetNumber=this.options.sheetNumber,this.addSheetButtonDOM(),this.addEventListener()}},{key:"addSheetButtonDOM",value:function(){this.element=document.createElement("div"),this.element.classList.add("sheetbutton"),this.options.isActive&&this.element.classList.add("active"),this.element.setAttribute("id","sheetbutton_"+this.sheetNumber),this.element.style.width=this.getSheetButtonWidthForString(this.sheetName)+this.options.dimension.units,this.options.parent.element.appendChild(this.element),this.sheetActions=document.createElement("button"),this.sheetActions.classList.add("sheetactions"),this.sheetActions.innerText=":",this.sheetActions.style.left=this.getSheetButtonWidthForString(this.sheetName)+this.options.dimension.units,this.sheetNameLabel=document.createElement("label"),this.sheetNameLabel.innerText=this.sheetName,this.sheetNameInput=document.createElement("input"),this.sheetNameInput.setAttribute("type","text"),this.sheetNameInput.classList.add("hide"),this.sheetNameInput.value=this.sheetNameLabel.innerText,this.element.appendChild(this.sheetActions),this.element.appendChild(this.sheetNameLabel),this.element.appendChild(this.sheetNameInput);var t=this.getSheetNameCalculatedWidth();this.sheetNameLabel.style.width=t,this.sheetNameInput.style.width=t}},{key:"getSheetNameCalculatedWidth",value:function(){return y.getPxFromStyle(this.sheetActions.style.left)-this.sheetActions.getBoundingClientRect().width/2+this.options.dimension.units}},{key:"addEventListener",value:function(){var t=this,e=this.options.parent.options.parent.options.parent;this.element.addEventListener("click",function(n){e.innerContainer.sheetContainer.sheets.forEach(function(e){e.sheetNumber===t.sheetNumber?e.show():(e.hide(),e.sheetButton.makeInActive())}),t.makeActive()}),this.sheetNameLabel.addEventListener("dblclick",function(e){t.sheetNameInput.classList.remove("hide"),t.sheetNameLabel.classList.add("hide");var n=t.getSheetNameCalculatedWidth();t.sheetNameInput.style.width=n,t.sheetNameInput.focus()}),this.sheetNameInput.addEventListener("blur",function(e){t.sheetNameInput.classList.add("hide"),t.sheetNameLabel.classList.remove("hide"),t.sheetNameLabel.innerText=t.sheetNameInput.value,t.sheetName=t.sheetNameInput.value,t.adjustSheetButtonWidth(e.target.value)}),this.sheetNameInput.addEventListener("keydown",function(e){"Enter"===e.code&&(t.sheetNameInput.classList.add("hide"),t.sheetNameLabel.classList.remove("hide"),t.sheetNameLabel.innerText=t.sheetNameInput.value,t.sheetName=t.sheetNameInput.value,t.adjustSheetButtonWidth(e.target.value))})}},{key:"adjustSheetButtonWidth",value:function(t){this.sheetNameLabel.style.width=this.getWidthForSheetNameLabel(t)+this.options.dimension.units,this.sheetNameInput.style.width=this.sheetNameLabel.style.width,this.sheetActions.style.left=y.getPxFromStyle(this.sheetNameLabel.style.width)+this.sheetActions.getBoundingClientRect().width+this.options.dimension.units,this.element.style.width=y.getPxFromStyle(this.sheetNameLabel.style.width)+2*this.sheetActions.getBoundingClientRect().width+this.options.dimension.units,console.log(this.element.style.width),this.options.parent.adjustWidthForSheetButtonContainer()}},{key:"makeActive",value:function(){this.element.classList.add("active")}},{key:"makeInActive",value:function(){this.element.classList.remove("active")}},{key:"getSheetButtonWidthForString",value:function(t){return this.sheetActions?y.getTextDisplayWidth(t+Array(5).fill("   ").join(""),this)+this.sheetActions.getBoundingClientRect().width:y.getTextDisplayWidth(t+Array(20).fill(" ").join(""),this)}},{key:"getWidthForSheetNameLabel",value:function(t){return y.getTextDisplayWidth(t+Array(20).fill(" ").join(""),this)}}])&&A(n.prototype,o),i&&A(n,i),e}();function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function D(t,e){return!e||"object"!==z(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var X=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=D(this,V(e).call(this,t,n))).options=n,o.logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("div"),this.element.classList.add("rowresizehandle"),this.element.setAttribute("draggable","true"),this.options.parent.element.appendChild(this.element),this.sheet=this.options.parent.options.parent.options.parent,this.addEventListener()}},{key:"addEventListener",value:function(){var t=this;this.element.addEventListener("dragstart",function(e){e.dataTransfer.dropEffect="link",t.dragStartYPos=e.clientY}),this.element.addEventListener("dragend",function(e){t.dragStopYPos=e.clientY,t.resizeRow()})}},{key:"resizeRow",value:function(){var t=this.dragStopYPos-this.dragStartYPos;this.options.parent.adjustHeightForAllCellsAcrossColumns(t)}}])&&M(n.prototype,o),i&&M(n,i),e}();function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function K(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Z(t,e){return(Z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var q=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=K(this,Q(e).call(this,t,n))).logger=new r(o.constructor.name),o.options=n,o.columnNumber=o.options.columnNumber,o.rowNumber=o.options.rowNumber,o.cellContent="",o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Z(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("div"),this.element.classList.add("row"),this.element.setAttribute("id","sheetrow_"+this.rowNumber),this.element.style.height=this.options.defaultRowHeight+this.options.dimension.units,this.element.style.width=this.options.parent.element.style.width,this.options.parent.element.appendChild(this.element),this.cellContentElement=document.createElement("div"),this.cellContentElement.classList.add("cellcontent"),this.element.appendChild(this.cellContentElement),this.updateSheetHeight(),this.options.isGutter&&(this.autoWidth=!0,this.element.classList.add("gutter"),this.addGutterInformation()),this.addResizeHandles(),this.addEventListener()}},{key:"updateSheetHeight",value:function(){this.options.parent.options.parent.element.style.width=this.addHeightToSheet()+this.options.dimension.units}},{key:"addHeightToSheet",value:function(){this.options.parent.options.parent.element;return(this.options.parent.columnCount+2)*this.element.getBoundingClientRect().height}},{key:"addGutterInformation",value:function(){this.rowNumber>0&&0==this.columnNumber&&this.options.isGutter&&(this.cellContent=this.getGutterInformation().row+"",this.setContent(this.cellContent)),0==this.rowNumber&&this.options.isGutter&&(this.cellContent=this.getGutterInformation().column+"",this.setContent(this.cellContent))}},{key:"getGutterInformation",value:function(){return{row:this.getGutterRowNumber(),column:this.getGutterColumnName()}}},{key:"getGutterRowNumber",value:function(){return this.rowNumber}},{key:"getGutterColumnName",value:function(){return y.getColumnNameFromColumnNumber(this.columnNumber)}},{key:"getWidthForAdjustment",value:function(){var t=this.getContentWidth();return this.options.parent.element.getBoundingClientRect().width>t&&0==this.rowNumber?0:t}},{key:"getContentWidth",value:function(){return y.getTextDisplayWidth(this.cellContent,this)+this.options.gutterPadding}},{key:"addResizeHandles",value:function(){this.rowResizeHandle=new X(null,Object.assign({},this.options,{parent:this,columnNumber:this.columnNumber}))}},{key:"setContent",value:function(t){this.cellContentElement.innerHTML=t}},{key:"getContent",value:function(){return this.cellContentElement.innerHTML}},{key:"adjustHeight",value:function(t){this.element.style.height=this.getHeight()+t+this.options.dimension.units}},{key:"getHeight",value:function(){return parseInt(this.element.style.height.substring(0,this.element.style.height.indexOf("px")))}},{key:"adjustHeightForAllCellsAcrossColumns",value:function(t){var e=this;this.options.parent.options.parent.columns.forEach(function(n){n.cells[e.rowNumber].adjustHeight(t)})}},{key:"addEventListener",value:function(){var t=this;this.sheetContainer=this.options.parent.options.parent.options.parent,this.options.isGutter||this.element.addEventListener("dblclick",function(e){t.hideChildren(),t.sheetContainer.sheetEditorCell.showAtCell(t)})}},{key:"hideChildren",value:function(){this.cellContentElement.classList.add("hide"),this.rowResizeHandle.element.classList.add("hide")}},{key:"showChildren",value:function(){this.cellContentElement.classList.remove("hide"),this.rowResizeHandle.element.classList.remove("hide")}}])&&U(n.prototype,o),i&&U(n,i),e}();function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function et(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nt(t){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ot(t,e){return(ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=et(this,nt(e).call(this,t,n))).options=n,o.logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ot(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("div"),this.element.classList.add("columnresizehandle"),this.element.style.height=this.options.parent.element.getBoundingClientRect().height+2*this.options.parent.cells.length+this.options.dimension.units,this.element.style.top=0+this.options.dimension.units,this.element.style.left=this.options.parent.getWidth()-this.options.columnResizeHandlesWidth+this.options.dimension.units,this.element.setAttribute("draggable","true"),this.options.parent.element.appendChild(this.element),this.addEventListener()}},{key:"addEventListener",value:function(){var t=this;this.element.addEventListener("dragstart",function(e){e.dataTransfer.dropEffect="link",t.dragStartXPos=e.clientX}),this.element.addEventListener("dragend",function(e){t.dragStopXPos=e.clientX,t.resizeColumn()})}},{key:"resizeColumn",value:function(){var t=this.dragStopXPos-this.dragStartXPos;this.options.parent.adjustWidth(t),this.element.style.left=this.getLeftPosition()+t+this.options.dimension.units}},{key:"getLeftPosition",value:function(){return parseInt(this.element.style.left.substring(0,this.element.style.left.indexOf("px")))}}])&&tt(n.prototype,o),i&&tt(n,i),e}();function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ut(t,e){return!e||"object"!==rt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lt(t){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function at(t,e){return(at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ht=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ut(this,lt(e).call(this,t,n))).options=n,o.columnNumber=o.options.columnNumber,o.cells=new Array,o.rowCount=0,o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("div"),this.element.classList.add("column"),this.element.setAttribute("id","sheetcolumn_"+this.columnNumber),this.element.style.width=this.options.defaultColumnWidth+this.options.dimension.units,this.options.isGutter?this.element.style.left=this.columnNumber*this.options.defaultColumnWidth+this.options.dimension.units:this.element.style.left=this.columnNumber*this.options.defaultColumnWidth-(this.options.defaultColumnWidth-this.options.parent.gutterColumn.getWidth())+this.options.dimension.units,this.options.parent.element.appendChild(this.element),this.addRows(),this.addResizeHandles()}},{key:"addRows",value:function(){this.cells.push(new q(null,Object.assign({},this.options,{parent:this,columnNumber:this.columnNumber,rowNumber:this.rowCount,isGutter:!0}))),this.rowCount++;for(var t=0;t<this.options.initialRows;t++)this.cells.push(new q(null,Object.assign({},this.options,{parent:this,columnNumber:this.columnNumber,rowNumber:this.rowCount,isGutter:this.options.isGutter}))),this.rowCount++;this.options.isGutter&&this.updateColumnWidthForGutterColumn()}},{key:"updateColumnWidthForGutterColumn",value:function(){if(this.options.isGutter){var t=this.cells[this.cells.length-1].getWidthForAdjustment();0!=t&&(this.setWidth(t),this.cascadeWidthToChildren())}}},{key:"cascadeWidthToChildren",value:function(){var t=this;this.cells.forEach(function(e){e.element.style.width=t.element.style.width})}},{key:"setWidth",value:function(t){this.element.style.width=t+this.options.dimension.units}},{key:"adjustWidth",value:function(t){var e=this.element.getBoundingClientRect().width;this.element.style.width=e+t+this.options.dimension.units;this.element.getBoundingClientRect().width;this.cascadeWidthToChildren(),this.updateOtherColumnsLeftPosition(t)}},{key:"getWidth",value:function(){return y.getPxFromStyle(this.element.style.width)}},{key:"setLeftPosition",value:function(t){this.element.style.left=t+this.options.dimension.units}},{key:"getLeftPosition",value:function(){return y.getPxFromStyle(this.element.style.left)}},{key:"addResizeHandles",value:function(){this.columnResizehandle=new it(null,Object.assign({},this.options,{parent:this,columnNumber:this.columnNumber,isGutter:this.options.isGutter}))}},{key:"updateOtherColumnsLeftPosition",value:function(t){var e=this;this.options.parent.columns.forEach(function(n){n.columnNumber>e.columnNumber&&n.setLeftPosition(t+n.getLeftPosition())})}}])&&st(n.prototype,o),i&&st(n,i),e}();function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pt(t,e){return!e||"object"!==ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yt=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=pt(this,mt(e).call(this,t,n))).options=n,o.logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dt(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.isVisibleFlag=!1,this.rowHighlighterLine=document.createElement("div"),this.rowHighlighterLine.classList.add("rowhighlighterline"),this.rowHighlighterLine.classList.add("hide"),this.rowHighlighterLine.style.width=this.options.parent.options.parent.element.style.width,this.options.parent.element.appendChild(this.rowHighlighterLine)}},{key:"show",value:function(){this.rowHighlighterLine.classList.remove("hide"),this.isVisibleFlag=!0}},{key:"hide",value:function(){this.rowHighlighterLine.classList.add("hide");var t=this.options.parent;this.setPosition(t.getTop()+t.getHeight()),this.isVisibleFlag=!1}},{key:"isVisible",value:function(){return this.isVisibleFlag}},{key:"setPosition",value:function(t){this.rowHighlighterLine.style.top=t+this.options.dimension.units}}])&&ft(n.prototype,o),i&&ft(n,i),e}();function bt(t){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function vt(t,e){return!e||"object"!==bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ct(t,e){return(Ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ot=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=vt(this,wt(e).call(this,t,n))).logger=new r(o.constructor.name),o.columns=new Array,o.columnCount=0,o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ct(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.sheetName=this.options.sheetName,this.sheetNumber=this.options.sheetNumber,this.addSheetDOM(),this.addSheetButtonToBottomBar(),this.addColumnsToSheet()}},{key:"addRowResizeHighlighter",value:function(){this.rowResizeHighlighter=new yt(null,Object.assign({},this.options,{parent:this}))}},{key:"getRowResizeHighlighter",value:function(){return this.rowResizeHighlighter}},{key:"addColumnsToSheet",value:function(){this.gutterColumn=new ht(null,Object.assign({},this.options,{parent:this,columnNumber:this.columnCount,isGutter:!0})),this.columns.push(this.gutterColumn),this.columnCount++;for(var t=0;t<this.options.initialColumns;t++)this.columns.push(new ht(null,Object.assign({},this.options,{parent:this,columnNumber:this.columnCount,isGutter:!1}))),this.columnCount++}},{key:"addSheetDOM",value:function(){this.element=document.createElement("div"),this.element.classList.add("sheet"),this.element.setAttribute("id","sheet_"+this.sheetNumber),this.options.parent.element.appendChild(this.element),this.options.isActive||this.element.classList.add("hide")}},{key:"addSheetButtonToBottomBar",value:function(){var t=this.options.parent.options.parent.options.parent.bottomBar.sheetButtonContainer;this.sheetButton=new G(null,Object.assign({},this.options,{parent:t,sheetName:this.sheetName,sheetNumber:this.sheetNumber,isActive:this.options.isActive,sheet:this})),t.sheetButtons.push(this.sheetButton)}},{key:"show",value:function(){this.element.classList.remove("hide")}},{key:"hide",value:function(){this.element.classList.add("hide")}},{key:"addEventListener",value:function(){var t=this;this.element.addEventListener("dragover",function(e){t.getRowResizeHighlighter().isVisible()&&t.getRowResizeHighlighter().setPosition(e.screenY)})}}])&&gt(n.prototype,o),i&&gt(n,i),e}();function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kt(t,e){return!e||"object"!==St(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Et=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=kt(this,_t(e).call(this,t,n))).options=n,o.logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("textarea"),this.element.classList.add("editorcell"),this.element.classList.add("hide"),this.element.style.width="0px",this.element.style.height="0px",this.options.parent.element.appendChild(this.element),this.addEventListener()}},{key:"showAtCell",value:function(t){this.hideFromCell(),this.currentCell=t,this.element=this.options.parent.element.removeChild(this.element),this.currentCell.element.appendChild(this.element),this.element.style.width=.9*y.getPxFromStyle(this.currentCell.options.parent.element.style.width)+this.options.dimension.units,this.element.style.height=this.currentCell.element.style.height,this.element.classList.remove("hide"),this.element.value=this.getValueFromParentCell(),this.element.focus()}},{key:"hideFromCell",value:function(){this.currentCell&&this.element.parentElement==this.currentCell.element&&(this.element.classList.add("hide"),this.element=this.currentCell.element.removeChild(this.element),this.options.parent.element.appendChild(this.element),this.element.style.width="0px",this.element.style.height="0px",this.setCellContent(),this.clearContentFromEditorCell(),this.currentCell.showChildren())}},{key:"setCellContent",value:function(){this.currentCell.cellContentElement.textContent=this.getStringValueForCell(),this.currentCell.cellContent=this.getValueForCell()}},{key:"getStringValueForCell",value:function(){return this.element.value}},{key:"getValueForCell",value:function(){return this.element.value}},{key:"clearContentFromEditorCell",value:function(){this.element.value=""}},{key:"getValueFromParentCell",value:function(){return this.currentCell?this.currentCell.cellContentElement.textContent:""}},{key:"addEventListener",value:function(){var t=this;this.element.addEventListener("blur",function(e){t.hideFromCell()})}}])&&jt(n.prototype,o),i&&jt(n,i),e}();function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Tt(t,e){return!e||"object"!==Lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xt(t,e){return(xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rt=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Tt(this,Bt(e).call(this,t,n))).sheetCount=1,o.sheets=new Array,o.logger=new r(o.constructor.name),o.options=n,o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xt(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.createSheetContainerDOM(),this.addSheetsToInnerContainer(),this.addSheetEditorCell()}},{key:"addSheetEditorCell",value:function(){this.sheetEditorCell=new Et(null,Object.assign({},this.options,{parent:this}))}},{key:"createSheetContainerDOM",value:function(){this.element=document.createElement("div"),this.element.classList.add("sheetcontainer"),this.options.parent.element.appendChild(this.element)}},{key:"addSheetsToInnerContainer",value:function(){for(var t=0;t<this.options.initialSheets;t++)this.sheets.push(this.addSheetForInnerContainer(this.getSheetName(this.sheetCount,null),this.sheetCount,1==this.sheetCount)),this.sheetCount++;this.options.parent.options.parent.bottomBar.sheetButtonContainer.adjustWidthForSheetButtonContainer()}},{key:"addSheetForInnerContainer",value:function(t,e,n){return new Ot(null,Object.assign({},this.options,{parent:this,sheetName:t,sheetNumber:e,isActive:n}))}},{key:"getSheetName",value:function(t,e){return e?e+" "+t:this.options.defaultSheetNamePrefix+" "+t}}])&&Nt(n.prototype,o),i&&Nt(n,i),e}();function Ft(t){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function At(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ht(t,e){return!e||"object"!==Ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wt(t){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function It(t,e){return(It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gt=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ht(this,Wt(e).call(this,t,n))).logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.createInnerContainerDOM(),this.addSheetContainer()}},{key:"createInnerContainerDOM",value:function(){this.element=document.createElement("div"),this.element.style.width=this.getWidthForInnerContainer(this.options.dimension.width)+this.options.dimension.units,this.element.style.height=this.getHeightForInnerContainer(this.options.dimension.height)+this.options.dimension.units,this.element.style.top=this.getInnerContainerTop()+this.options.dimension.units,this.element.classList.add("innercontainer"),this.options.parent.element.appendChild(this.element)}},{key:"addSheetContainer",value:function(){this.sheetContainer=new Rt(null,Object.assign({},this.options,{parent:this}))}},{key:"getInnerContainerTop",value:function(){return this.options.parent.element.getBoundingClientRect().top+this.options.topbarHeight}},{key:"getWidthForInnerContainer",value:function(t){return t}},{key:"getHeightForInnerContainer",value:function(t){return t-(this.options.topbarHeight+this.options.bottombarHeight)}}])&&At(n.prototype,o),i&&At(n,i),e}();function zt(t){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Dt(t,e){return!e||"object"!==zt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vt(t){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yt(t,e){return(Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Dt(this,Vt(e).call(this,t,n))).options=n,o.logger=new r(o.constructor.name),o.render(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yt(t,e)}(e,l),n=e,(o=[{key:"render",value:function(){this.element=document.createElement("div"),this.element.style.width=this.options.dimension.width+this.options.dimension.units,this.element.style.height=this.options.dimension.height+this.options.dimension.units,this.element.classList.add("loader"),this.options.parent.element.appendChild(this.element)}},{key:"show",value:function(){var t=this;return new Promise(function(e,n){t.element.classList.remove("hide")})}},{key:"hide",value:function(){var t=this;return new Promise(function(e,n){t.element.classList.add("hide")})}}])&&Mt(n.prototype,o),i&&Mt(n,i),e}();function Jt(t){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kt(t,e){return!e||"object"!==Jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qt(t){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zt(t,e){return(Zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qt=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Kt(this,Qt(e).call(this,t,n))).init(),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zt(t,e)}(e,l),n=e,(o=[{key:"init",value:function(){this.element.style.width=this.options.dimension.width+this.options.dimension.units,this.element.style.height=this.options.dimension.height+this.options.dimension.units,this.element.classList.add("gridsheet"),this.renderLoader().then(function(){})}},{key:"render",value:function(){var t=this;this.renderMainParts().then(function(){t.loader.hide()})}},{key:"renderMainParts",value:function(){var t=this;return new Promise(function(e,n){t.renderSheetTopBar(),t.renderSheetBottomBar(),t.renderSheetInnerContainer(),e()})}},{key:"renderLoader",value:function(){var t=this;return new Promise(function(e,n){t.loader=new Xt(null,Object.assign({},t.options,{parent:t})),t.loader.show()})}},{key:"renderSheetInnerContainer",value:function(){this.innerContainer=new Gt(null,Object.assign({},this.options,{parent:this}))}},{key:"renderSheetTopBar",value:function(){this.topBar=new m(null,Object.assign({},this.options,{parent:this}))}},{key:"renderSheetBottomBar",value:function(){this.bottomBar=new R(null,Object.assign({},this.options,{parent:this}))}}])&&Ut(n.prototype,o),i&&Ut(n,i),e}();function $t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}new(function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.logger=new r(this.constructor.name),this.element=e,this.options=Object.assign({},s,n),this.initUI()}var e,n,o;return e=t,(n=[{key:"initUI",value:function(){this.renderSheetOuterContainer()}},{key:"renderSheetOuterContainer",value:function(){this.outerContainer=new qt(this.element,Object.assign({},this.options,{parent:this.outerContainer})),this.outerContainer.render()}}])&&$t(e.prototype,n),o&&$t(e,o),t}())(document.getElementById("gridsheet"),{})},93:function(t,e,n){}});
//# sourceMappingURL=app.d96b65bc.js.map